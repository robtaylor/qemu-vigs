#!/bin/sh

## User Define for desktop menu
currentPath=`pwd`
desktoppath=~/.local/share/applications

## vtm shortcut
vtm_desktopfile=$desktoppath/tizen-sdk-vtm.desktop
vtm_iconfile=vtm.ico
vtm_exefile=Emulator/bin/emulator-manager
vtm_comment="Emulator manager is a tool which can make a cloned emulator image"
vtm_name="Emulator Manager"

## Do not modify the followings (Make desktop menu)
TIZEN_SDK_INSTALL_PATH=`echo $INSTALLED_PATH`
if [ -z $TIZEN_SDK_INSTALL_PATH ]
then
#   echo "There is no TIZEN_SDK_PATH ENV" >> /tmp/emulator.log
   exit 2;
fi

iconpath=~/.local/share/icons

vtm_exepath=$TIZEN_SDK_INSTALL_PATH/$vtm_exefile

mkdir -p $iconpath

if test -e $TIZEN_SDK_INSTALL_PATH/temp/$vtm_iconfile 
then 
	cp -f $TIZEN_SDK_INSTALL_PATH/temp/$vtm_iconfile $iconpath/$vtm_iconfile
else
	echo "$vtm_iconfile does not exist!!"
	exit 1
fi

#cp -f $TIZEN_SDK_INSTALL_PATH/temp/$vtm_iconfile $iconpath/$vtm_iconfile

mkdir -p $desktoppath

## Create vtm .desktop file 
cat > $vtm_desktopfile << END
[Desktop Entry]
Encoding=UTF-8
Value=1.0
Type=Application
Terminal=false
Comment=$vtm_comment
Name=$vtm_name
Categories=$CATEGORY
StartupNotify=true
NoDisplay=false
END

cat >> $vtm_desktopfile << END
Icon=$iconpath/$vtm_iconfile
Exec=$vtm_exepath
END

## Register .desktop file
xdg-desktop-menu install $MENU_DIRECTORY_PATH $vtm_desktopfile
### END Register Menu ###
